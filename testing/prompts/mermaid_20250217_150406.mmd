%%{init: {'theme': 'base', 'themeVariables': {'background': '#F5F5DC', 'primaryColor': '#87CEEB', 'edgeLabelBackground': '#FF4500'}}}%%
flowchart TD
    subgraph User Interaction[User Interaction & Authentication]
        UI1[Users access via Web, Mobile, Smart TV, Gaming Console]
        UI2[Login via OAuth, Google, Facebook, Email]
        UI3[Multi-profile selection]
        UI4[Secure session handling]
    end

    subgraph Recommendation[Content Discovery & Recommendation]
        R1[Personalized homepage]
        R2[AI-powered recommendation using\ncollaborative filtering & deep learning]
        R3[Search with filters\nlike genre, language, release year]
        R4[Trending and Top 10 lists]
    end

    subgraph ContentManagement[Content Management & CDN Distribution]
        CM1[Content stored in a distributed database]
        CM2[Processed via CMS]
        CM3[Encoding & transcoding for multiple resolutions]
        CM4[CDN integration with edge servers]
        CM5[DRM enforcement]
    end

    subgraph Streaming[Streaming & Playback]
        S1[Adaptive Bitrate Streaming\nfor dynamic quality]
        S2[Video player with subtitles,\nmulti-audio tracks, playback speed control]
        S3[Buffering, preloading for seamless experience]
        S4[Watch history tracking & resume playback]
    end

    subgraph Analytics[User Activity & Engagement Tracking]
        A1[Real-time analytics on watch time,\nsession duration]
        A2[AI-powered insights for better recommendations]
        A3[Parental controls & content restrictions]
    end

    subgraph Billing[Billing & Subscription Management]
        B1[Subscription plans – Basic, Standard, Premium]
        B2[Secure payment gateways –\nCredit/Debit Cards, PayPal, Apple Pay, Google Pay]
        B3[Auto-renewal & cancellation options]
        B4[Notifications for payment failures]
    end

    subgraph Security[System Monitoring & Security]
        S1[Load balancing for traffic distribution]
        S2[Logging, error handling,\nserver health monitoring]
        S3[AI-driven fraud detection]
        S4[Compliance with GDPR, PCI-DSS,\nand regional data laws]
    end

    UI1 --> UI2
    UI2 --> UI3
    UI3 --> UI4
    UI4 --> R1

    R1 --> R2
    R2 --> R3
    R3 --> R4
    R4 --> CM1

    CM1 --> CM2
    CM2 --> CM3
    CM3 --> CM4
    CM4 --> CM5
    CM5 --> S1

    S1 --> S2
    S2 --> S3
    S3 --> S4

    S4 --> A1
    A1 --> A2
    A2 --> A3

    S4 --> B1
    B1 --> B2
    B2 --> B3
    B3 --> B4

    A1 --> S2
    S2 --> S1

    S4 --> S1
    S1 --> S2
    S2 --> S3

    Security --> UI2
    Security --> S1
    Security --> A1