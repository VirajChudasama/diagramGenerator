%%{init: {'theme': 'base', 'themeVariables': {'background': '#F5F5DC', 'primaryColor': '#87CEEB', 'edgeLabelBackground': '#FF4500'}}}%%
flowchart TD
    subgraph UserInteraction["User Interaction & Authentication"]
        UI1[("Access via Web, Mobile, Smart TV, Gaming Console")]:::lightblue --> UI2[("Login via OAuth, Google, Facebook, Email")]:::lightblue
        UI2 --> UI3[("Multi-profile selection")]:::lightblue
        UI3 --> UI4[("Secure session handling")]:::lightblue
    end

    subgraph ContentDiscovery["Content Discovery & Recommendation"]
        CD1[("Personalized homepage")]:::lightgreen --> CD2[("AI-powered recommendation\nusing collaborative filtering\n& deep learning")]:::lightgreen
        CD2 --> CD3[("Search with filters\nlike genre, language,\nrelease year")]:::lightgreen
        CD3 --> CD4[("Trending and Top 10 lists")]:::lightgreen
    end

    subgraph ContentManagement["Content Management & CDN Distribution"]
        CM1[("Content stored in a\ndistributed database,\nprocessed via CMS")]:::lightyellow --> CM2[("Encoding & transcoding\nfor multiple resolutions")]:::lightyellow
        CM2 --> CM3[("CDN integration\nwith edge servers")]:::lightyellow
        CM3 --> CM4[("DRM enforcement")]:::lightyellow
    end

    subgraph StreamingPlayback["Streaming & Playback"]
        SP1[("Adaptive Bitrate Streaming\nfor dynamic quality")]:::lightorange --> SP2[("Video player with\nsubtitles, multi-audio tracks,\nplayback speed control")]:::lightorange
        SP2 --> SP3[("Buffering, preloading\nfor seamless experience")]:::lightorange
        SP3 --> SP4[("Watch history tracking\n& resume playback")]:::lightorange
    end

    subgraph UserActivity["User Activity & Engagement Tracking"]
        UA1[("Real-time analytics on\nwatch time, session duration")]:::lightgrey --> UA2[("AI-powered insights\nfor better recommendations")]:::lightgrey
        UA2 --> UA3[("Parental controls\n& content restrictions")]:::lightgrey
    end

    subgraph BillingManagement["Billing & Subscription Management"]
        BM1[("Subscription plans –\nBasic, Standard, Premium")]:::lightred --> BM2[("Secure payment gateways –\nCredit/Debit Cards, PayPal,\nApple Pay, Google Pay")]:::lightred
        BM2 --> BM3[("Auto-renewal & cancellation options")]:::lightred
        BM3 --> BM4[("Notifications for\npayment failures")]:::lightred
    end

    subgraph SystemMonitoring["System Monitoring & Security"]
        SM1[("Load balancing for\ntraffic distribution")]:::lightgrey --> SM2[("Logging, error handling,\nserver health monitoring")]:::lightgrey
        SM2 --> SM3[("AI-driven fraud detection")]:::lightgrey
        SM3 --> SM4[("Compliance with GDPR,\nPCI-DSS,\nand regional data laws")]:::lightgrey
    end

    UI4 --> CD1
    CD4 --> CM1
    CM4 --> SP1
    SP4 --> UA1
    UA3 --> BM1
    BM4 --> SM1